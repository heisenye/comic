import{_ as B,m as C,T as F,d as V,f as I,n as A,h as E,p as L,B as z,r,o as l,c as u,a as t,k as D,b as n,t as o,q as a,F as k,j as w,w as h,s as S,u as U,v as y,x as T,y as j,z as q,A as H,C as M,D as P,E as G,G as K}from"./index-VyQC9v5j.js";const J={name:"TheBook",components:{TheButton:C,TheIcon:F,TheImage:V},props:{comic:{type:Object,required:!0}},setup(x){const{comic:c}=x,{token:i}=U(),e=I(!1),{name:v,_id:_,coverImage:d,updatedAt:p,chapters:g,author:f,tags:s,description:N,status:O}=c,{viewCount:R,favoriteCount:b}=A(c);return E(async()=>{if(i.value)try{(await L(_)).data&&(e.value=!0)}catch(m){console.error(m)}}),{BASE_URL:z,isFavorited:e,id:_,coverImage:d,name:v,date:p,viewCount:R,favoriteCount:b,chapters:g,author:f,tags:s,description:N,status:O,addOrDeleteFavoriteFn:async()=>{try{if(!i.value){T({msg:y.NO_TOKEN,messageType:"info",popupType:"alert"});return}e.value?(await j(_)).code===200&&(e.value=!1,b.value--,T({msg:y.DELETE_FAVORITE_SUCCESS,messageType:"success",popupType:"toast",toastPos:["end","bottom"]})):(await q({id:_})).code===200&&(e.value=!0,b.value++,T({msg:y.ADD_FAVORITE_SUCCESS,messageType:"success",popupType:"toast",toastPos:["start","bottom"]}))}catch(m){console.error(m)}}}}},Q={class:"absolute w-full top-20 px-3 sm:px-4 md:px-6 lg:px-4"},W={class:"relative left-1/2 -translate-x-1/2 w-full card rounded max-w-3xl bg-primary lg:card-side lg:py-4"},X={key:0,class:"absolute bookmark border-[32px] -left-4 -top-4 xl:border-[40px]"},Y=t("p",{class:"absolute -left-6 -top-6 xl:text-lg font-base_3"},"完结",-1),Z=[Y],$={class:"relative flex justify-center pb-6 pt-8 lg:w-3/5"},ee={class:"card-body pt-4 px-6 md:px-6 rounded-b-xl xl:text-lg"},te={class:"font-base_3 card-title text-2xl xl:text-3xl self-center pb-2"},se={class:"text-accent"},oe=t("i",{class:"fa-solid fa-eye"},null,-1),ae=t("i",{class:"fa-solid fa-heart"},null,-1),ne=t("i",{class:"fa-solid fa-book"},null,-1),ce={class:"font-base_2"},le={class:"btn btn-sm btn-secondary"},re={class:"font-base_2 space-x-1.5"},ie={class:"font-base_2"},de=t("h1",{class:"font-base_3 text-lg mx-auto"},"章节",-1),_e={class:"grid grid-cols-4 gap-x-6 place-items-center"};function pe(x,c,i,e,v,_){const d=r("TheImage"),p=r("TheIcon"),g=r("TheButton"),f=r("RouterLink");return l(),u("main",Q,[t("div",W,[e.status==="completed"?(l(),u("div",X,Z)):D("",!0),t("div",$,[n(d,{src:`${e.BASE_URL}/${e.id}/${e.coverImage.chapter}/${e.coverImage.page}.webp`,class:"rounded-lg w-3/5 lg:rounded-lg h-fit"},null,8,["src"])]),t("div",ee,[t("h1",te,o(e.name),1),t("div",se,[t("span",null,o(new Date(e.date).toLocaleDateString()),1),a("  |  "),oe,a("  "),t("span",null,o(e.viewCount),1),a("  "),ae,a("  "),t("span",null,o(e.favoriteCount),1),a("  |  "),ne,a("  "),t("span",null,o(e.chapters),1)]),t("div",ce,[a(" 作者："),t("button",le,o(e.author),1)]),t("div",re,[a(" 标签： "),(l(!0),u(k,null,w(e.tags,s=>(l(),u("button",{key:s,class:"btn btn-sm btn-secondary"},o(s),1))),128))]),t("div",ie,"简介："+o(e.description),1),n(g,{type:"error",class:"w-32 lg:w-28 xl:w-32 mx-auto my-3",onClick:e.addOrDeleteFavoriteFn},{default:h(()=>[n(p,{type:"heart",class:"text-lg lg:text-md xl:text-lg text-white",variant:e.isFavorited?"solid":"regular"},null,8,["variant"])]),_:1},8,["onClick"]),de,t("div",_e,[(l(!0),u(k,null,w(e.chapters,s=>(l(),S(f,{key:s,to:{name:"read",params:{id:e.id,chapter:s}},class:"btn btn-sm btn-secondary w-12",replace:""},{default:h(()=>[a(o(s),1)]),_:2},1032,["to"]))),128))])])])])}const me=B(J,[["render",pe]]),ue={name:"BookView",components:{TheBook:me,TheNavigation:H,TheButton:C,TheIcon:F},setup(){const x=M(),{id:c}=x.params,i=I(null);return E(async()=>{try{const e=await P(c);e.code===200&&(i.value=e.data)}catch(e){console.error(e)}}),{comic:i,goBack:G,goHome:K}}},he=t("span",{class:"text-xl 2xl:text-2xl 2xl:tracking-widest"},"<  Back",-1),xe=[he],ge={class:"nav-input-container"},fe=t("input",{type:"text",placeholder:"搜索标题或标签",class:"nav-input"},null,-1);function ve(x,c,i,e,v,_){const d=r("TheIcon"),p=r("TheButton"),g=r("TheNavigation"),f=r("TheBook");return l(),u("main",null,[n(g,{class:"z-50"},{left:h(()=>[t("div",{class:"text-white btn btn-ghost tracking-wider font-medium text-lg px-4",onClick:c[0]||(c[0]=(...s)=>e.goBack&&e.goBack(...s))},xe)]),right:h(()=>[t("div",ge,[fe,n(d,{type:"magnifying-glass",class:"absolute left-4"})]),n(p,{type:"ghost",size:"md",shape:"circle",class:"lg:hidden btn-md text-white"},{default:h(()=>[n(d,{type:"magnifying-glass",class:"text-base sm:text-lg xl:text-xl 2xl:text-2xl lg:hidden"})]),_:1}),n(p,{type:"ghost",size:"md",shape:"circle",class:"btn-md text-white",onClick:e.goHome},{default:h(()=>[n(d,{type:"house",class:"text-base sm:text-lg xl:text-xl 2xl:text-2xl"})]),_:1},8,["onClick"])]),_:1}),e.comic?(l(),S(f,{key:0,comic:e.comic,class:"z-0"},null,8,["comic"])):D("",!0)])}const Te=B(ue,[["render",ve]]);export{Te as default};
