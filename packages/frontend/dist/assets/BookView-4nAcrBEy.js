import{_ as B,m as C,T as F,d as V,f as I,n as A,h as E,p as L,B as z,r,o as l,c as u,a as e,k as D,b as n,t as s,q as a,F as k,j as w,w as h,s as S,u as U,v as b,x as T,y as j,z as q,A as H,C as M,D as P,E as G,G as K}from"./index-stNcuBHF.js";const J={name:"TheBook",components:{TheButton:C,TheIcon:F,TheImage:V},props:{comic:{type:Object,required:!0}},setup(x){const{comic:c}=x,{token:i}=U(),t=I(!1),{name:v,_id:_,coverImage:d,updatedAt:p,chapters:g,author:f,tags:o,description:N,status:O}=c,{viewCount:R,favoriteCount:y}=A(c);return E(async()=>{if(i.value)try{(await L(_)).data&&(t.value=!0)}catch(m){console.error(m)}}),{BASE_URL:z,isFavorited:t,id:_,coverImage:d,name:v,date:p,viewCount:R,favoriteCount:y,chapters:g,author:f,tags:o,description:N,status:O,addOrDeleteFavoriteFn:async()=>{try{if(!i.value){T({msg:b.NO_TOKEN,messageType:"info",popupType:"alert"});return}t.value?(await j(_)).code===200&&(t.value=!1,y.value--,T({msg:b.DELETE_FAVORITE_SUCCESS,messageType:"success",popupType:"toast",toastPos:["end","bottom"]})):(await q({id:_})).code===200&&(t.value=!0,y.value++,T({msg:b.ADD_FAVORITE_SUCCESS,messageType:"success",popupType:"toast",toastPos:["start","bottom"]}))}catch(m){console.error(m)}}}}},Q={class:"absolute w-full top-20 px-3 sm:px-4 md:px-6 lg:px-4"},W={class:"relative left-1/2 -translate-x-1/2 w-full card rounded max-w-3xl bg-primary lg:card-side lg:py-4"},X={key:0,class:"absolute bookmark border-[32px] -left-4 -top-4 xl:border-[40px]"},Y=e("p",{class:"absolute -left-6 -top-6 xl:text-lg font-cn_3"},"完结",-1),Z=[Y],$={class:"relative flex justify-center pb-6 pt-8 lg:w-3/5"},tt={class:"card-body pt-4 px-6 md:px-6 rounded-b-xl xl:text-lg"},et={class:"font-cn_3 card-title text-2xl xl:text-3xl self-center pb-2"},ot={class:"text-accent"},st=e("i",{class:"fa-solid fa-eye"},null,-1),at=e("i",{class:"fa-solid fa-heart"},null,-1),nt=e("i",{class:"fa-solid fa-book"},null,-1),ct={class:"font-cn_2"},lt={class:"btn btn-sm btn-secondary"},rt={class:"font-cn_2 space-x-1.5"},it={class:"font-cn_2"},dt=e("h1",{class:"font-cn_3 text-lg mx-auto"},"章节",-1),_t={class:"grid grid-cols-4 gap-x-6 place-items-center"};function pt(x,c,i,t,v,_){const d=r("TheImage"),p=r("TheIcon"),g=r("TheButton"),f=r("RouterLink");return l(),u("main",Q,[e("div",W,[t.status==="completed"?(l(),u("div",X,Z)):D("",!0),e("div",$,[n(d,{src:`${t.BASE_URL}/${t.id}/${t.coverImage.chapter}/${t.coverImage.page}.webp`,class:"rounded-lg w-3/5 lg:rounded-lg h-fit"},null,8,["src"])]),e("div",tt,[e("h1",et,s(t.name),1),e("div",ot,[e("span",null,s(new Date(t.date).toLocaleDateString()),1),a("  |  "),st,a("  "),e("span",null,s(t.viewCount),1),a("  "),at,a("  "),e("span",null,s(t.favoriteCount),1),a("  |  "),nt,a("  "),e("span",null,s(t.chapters),1)]),e("div",ct,[a(" 作者："),e("button",lt,s(t.author),1)]),e("div",rt,[a(" 标签： "),(l(!0),u(k,null,w(t.tags,o=>(l(),u("button",{key:o,class:"btn btn-sm btn-secondary"},s(o),1))),128))]),e("div",it,"简介："+s(t.description),1),n(g,{type:"error",class:"w-32 lg:w-28 xl:w-32 mx-auto my-3",onClick:t.addOrDeleteFavoriteFn},{default:h(()=>[n(p,{type:"heart",class:"text-lg lg:text-md xl:text-lg text-white",variant:t.isFavorited?"solid":"regular"},null,8,["variant"])]),_:1},8,["onClick"]),dt,e("div",_t,[(l(!0),u(k,null,w(t.chapters,o=>(l(),S(f,{key:o,to:{name:"read",params:{id:t.id,chapter:o}},class:"btn btn-sm btn-secondary w-12",replace:""},{default:h(()=>[a(s(o),1)]),_:2},1032,["to"]))),128))])])])])}const mt=B(J,[["render",pt]]),ut={name:"BookView",components:{TheBook:mt,TheNavigation:H,TheButton:C,TheIcon:F},setup(){const x=M(),{id:c}=x.params,i=I(null);return E(async()=>{try{const t=await P(c);t.code===200&&(i.value=t.data)}catch(t){console.error(t)}}),{comic:i,goBack:G,goHome:K}}},ht=e("span",{class:"text-xl 2xl:text-2xl 2xl:tracking-widest"},"<  Back",-1),xt=[ht],gt={class:"comic-input-container"},ft=e("input",{type:"text",placeholder:"搜索标题或标签",class:"comic-input"},null,-1);function vt(x,c,i,t,v,_){const d=r("TheIcon"),p=r("TheButton"),g=r("TheNavigation"),f=r("TheBook");return l(),u("main",null,[n(g,{class:"z-50"},{left:h(()=>[e("div",{class:"text-white btn btn-ghost tracking-wider font-medium text-lg px-4",onClick:c[0]||(c[0]=(...o)=>t.goBack&&t.goBack(...o))},xt)]),right:h(()=>[e("div",gt,[ft,n(d,{type:"magnifying-glass",class:"absolute left-4"})]),n(p,{type:"ghost",size:"md",shape:"circle",class:"btn-md text-white"},{default:h(()=>[n(d,{type:"magnifying-glass",class:"text-base sm:text-lg xl:text-xl 2xl:text-2xl lg:hidden"})]),_:1}),n(p,{type:"ghost",size:"md",shape:"circle",class:"btn-md text-white",onClick:t.goHome},{default:h(()=>[n(d,{type:"house",class:"text-base sm:text-lg xl:text-xl 2xl:text-2xl"})]),_:1},8,["onClick"])]),_:1}),t.comic?(l(),S(f,{key:0,comic:t.comic,class:"z-0"},null,8,["comic"])):D("",!0)])}const Tt=B(ut,[["render",vt]]);export{Tt as default};
