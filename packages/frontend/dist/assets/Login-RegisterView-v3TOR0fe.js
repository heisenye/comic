import{_ as S,R as E,m as R,T as F,C as N,P as U,f as r,G as L,r as h,c as a,a as s,b as d,w as u,k,q as m,N as w,O as v,x as _,v as b,Q as V,S as I,U as B,o as l,L as M,u as O}from"./index-stNcuBHF.js";const P={name:"Login-Register",components:{RouterLink:E,TheButton:R,TheIcon:F},setup(){const f=N(),t=U(),{setToken:T}=O(),e=r(f.fullPath==="/login"),p=r(""),g=r(""),y=r(""),c=r(!1);return{isLogin:e,isSuccess:c,username:p,pwd:g,email:y,goHome:L,loginFn:async()=>{const i={username:p.value,pwd:g.value};for(const o in i)if(!i[o]){_({msg:b.INCOMPLETE_FORM,messageType:"info",popupType:"alert"});return}try{const o=await V(i);if(o.code===200){t.setUser(o.data);const C=o.data.token;T(C),c.value=!0,_({msg:b.LOGIN_SUCCESS,messageType:"success",popupType:"toast",toastPos:["bottom","end"]}),setTimeout(()=>{f.name==="login"&&L()},2e3)}}catch(o){console.error(o)}},registerFn:async()=>{const i={username:p.value,pwd:g.value};for(const o in i)if(!i[o]){_(b.INCOMPLETE_FORM);return}try{(await I(i)).code===200&&(c.value=!0,_({msg:b.REGISTER_SUCCESS,messageType:"success",popupType:"toast",toastPos:["bottom","end"]}),setTimeout(()=>{B()},1e3))}catch(o){console.error(o)}}}}},H={class:"flex justify-center items-center h-screen"},z={class:"card bg-primary shadow-md shadow-accent max-w-lg w-4/5"},G={class:"card-body pb-6 pt-8 font-cn_2"},j={class:"card-title my-4 tracking-wider whitespace-nowrap justify-between"},q={key:0,class:"text-lg md:text-xl lg:text-2xl"},D={key:1,class:"text-lg md:text-xl lg:text-2xl"},Q={class:"md:space-y-4 lg:space-y-6"},A={class:"form-control"},J={for:"username",class:"label"},K={class:"label-text"},W={key:0,class:"text-warning"},X={class:"form-control"},Y={for:"pwd",class:"label"},Z={class:"label-text"},$={key:0,class:"text-warning"},ee={key:0,class:"form-control"},se=s("label",{for:"email",class:"label"},[s("span",{class:"label-text"},[s("span",{class:"text-warning"},"*"),m("Email")])],-1),te={key:0,class:"label"},oe=s("a",{class:"label-text-alt link link-hover text-info"},"忘记密码?",-1),ne={key:1,class:"label"};function ae(f,t,T,e,p,g){const y=h("TheIcon"),c=h("TheButton"),x=h("RouterLink");return l(),a("main",H,[s("div",z,[s("div",G,[s("div",j,[d(c,{type:"secondary",size:"sm",class:"self-start lg:btn-md",onClick:e.goHome},{default:u(()=>[d(y,{type:"house",class:"lg:text-lg"})]),_:1},8,["onClick"]),e.isLogin?(l(),a("span",q,"登入 Heisenye")):(l(),a("span",D,"注册 Heisenye")),d(c,{type:"accent",size:"sm",shape:"circle",class:"lg:btn-md"},{default:u(()=>[s("i",{class:M(["fa-solid text-base",{"fa-lock":!e.isSuccess,"fa-lock-open":e.isSuccess}])},null,2)]),_:1})]),s("div",Q,[s("div",A,[s("label",J,[s("span",K,[e.isLogin?k("",!0):(l(),a("span",W,"*")),m("用户名")])]),w(s("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=n=>e.username=n),type:"text",placeholder:"用户名",class:"input input-bordered bg-secondary border-accent focus:border-info lg:text-lg lg:py-6 font-Noto"},null,512),[[v,e.username]])]),s("div",X,[s("label",Y,[s("span",Z,[e.isLogin?k("",!0):(l(),a("span",$,"*")),m("密码")])]),w(s("input",{id:"pwd","onUpdate:modelValue":t[1]||(t[1]=n=>e.pwd=n),type:"password",placeholder:"密码",class:"input input-bordered bg-secondary border-accent focus:border-info lg:text-lg lg:py-6 font-Noto"},null,512),[[v,e.pwd]])]),e.isLogin?k("",!0):(l(),a("div",ee,[se,w(s("input",{id:"email","onUpdate:modelValue":t[2]||(t[2]=n=>e.email=n),type:"email",placeholder:"Email",class:"input input-bordered bg-secondary"},null,512),[[v,e.email]])]))]),e.isLogin?(l(),a("div",te,[oe,d(x,{to:{name:"register"},class:"label-text-alt link link-hover text-info"},{default:u(()=>[m("注册")]),_:1})])):(l(),a("div",ne,[d(x,{to:{name:"login"},class:"label-text-alt link link-hover text-info"},{default:u(()=>[m("登录")]),_:1})])),e.isLogin?(l(),a("button",{key:2,class:"btn btn-md btn-info text-base mb-4 md:mb-6 md:mt-4",onClick:t[3]||(t[3]=(...n)=>e.loginFn&&e.loginFn(...n))}," 登入 ")):(l(),a("button",{key:3,class:"btn btn-md btn-info text-base mb-4 md:mb-6",onClick:t[4]||(t[4]=(...n)=>e.registerFn&&e.registerFn(...n))}," 注册 "))])])])}const ie=S(P,[["render",ae]]);export{ie as default};
